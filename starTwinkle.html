<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>一起来看星星吧</title>
</head>
<body>
<canvas id="canvas"></canvas>
</body>
</html>
<script type="text/javascript">
  var canvas = document.getElementById('canvas')
  var context = canvas.getContext("2d");
  var h = window.innerHeight
  var w = window.innerWidth
  var starArr = []
  var starNum = 20  //设置星星个数
  var starColorArr = ['red', 'white', 'yellow']  //星星随机颜色数组
  var rSpeed = 1
  var RSpeed = 1.3   //星星闪烁速度
  canvas.height = h
  canvas.width = w * 0.8
  creatStarArr()  //创建星星数组
  firstDraw()     //初次绘制
  draw()          //循环绘制


  function starAttr(r, R, rMax, RMax, x, y, rot, rotSpeed, color) {
    let star = {
      r,
      R,  //当前星星的半径大小
      rMax,
      RMax,   //最大半径大小
      x,
      y,      //坐标
      rot,    //角度保存
      rotSpeed,
      color
    }
    return star
  }

  function firstDraw() {
    context.clearRect(0, 0 ,w * 0.8 ,h )
    for( let i = 0 ; i < starNum ;i++ ) {
      drawStar(context, starArr[i].r, starArr[i].R, starArr[i].x, starArr[i].y, starArr[i].rot, 3, starColorArr[starArr[i].color], starColorArr[starArr[i].color])
    }
  }
  function draw() {
    setInterval(() =>{
        for( var i = 0 ; i < starNum ; i++){
          var star = starArr[i]
          star.rot += star.rotSpeed
          star.r +=  rSpeed
          star.R += RSpeed
          if (star.rot > 72) {
            star.rot -= 72
          }
          else if(star.rot < 0){
            star.rot += 72
          }}
        firstDraw()
      },10
    )
  }

  function creatStarArr() {  //设置星星数组
    for(let i = 0 ; i < starNum ;i++){
      let rMax = randomBetween( 11 ,20 )
      let RMax = rMax + 7
      starArr.push(starAttr(0, 0, rMax,RMax ,randomBetween( 0 ,w * 0.8 ) ,randomBetween( 0 , h ), randomBetween( 0 , 72) , randomBetween(-100, 100)/80 ,randomBetween(-1, starColorArr.length-1))
      )}
  }

  function drawStar( cxt , r , R , x , y , rot , borderWidth , borderStyle , fillStyle){
    cxt.beginPath();
    for( let i = 0 ; i < 5 ; i ++){
      cxt.lineTo(Math.cos((18+72*i - rot)/180*Math.PI) * R + x ,- Math.sin((18+72*i - rot )/180*Math.PI) * R + y);
      cxt.lineTo(Math.cos((54+72*i - rot)/180*Math.PI) * r + x ,- Math.sin((54+72*i - rot )/180*Math.PI) * r + y);
    }
    cxt.closePath();

    cxt.lineWidth = borderWidth;
    cxt.strokeStyle = borderStyle;
    cxt.fillStyle = fillStyle;

    cxt.fill();
    cxt.stroke();
  }

  function randomBetween( x ,y ) {  //寻找大于x  小于等于y 之间的随机数  y 需要大于x
    return Math.floor(Math.random() * (y - x + 1) + x)
  }
</script>
<style>
  *{
    margin: 0;
    padding: 0;
  }
  #canvas{
    display: flex;
    width: 80%;
    height: 100%;
    margin: 0 auto;
    background: linear-gradient(black , darkslateblue);
  }
</style>
